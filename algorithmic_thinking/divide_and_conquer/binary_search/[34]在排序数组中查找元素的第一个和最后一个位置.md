# [34. 在排序数组中查找元素的第一个和最后一个位置](https://leetcode.cn/problems/find-first-and-last-position-of-element-in-sorted-array)

## 思路

二分查找

查找区间范围，需要查找第一个 ≥ target 的元素 + 第一个 ＞ target 的元素。

因此需要两次二分，第一次查找第一个 ≥ target 的元素，第二次查找第一个 ＞ target + 1 的元素

## 解法

### 二分查找

**闭区间** 写法

```java
class Solution {
    public int[] searchRange(int[] nums, int target) {
        // 找第一个大于等于 target 的数
        int start = lowerBound(nums, target);
        // start 等于数组长度说明所有数都小于 target
        // start 等于 0 说明所有数都大于 target，或者 nums[0] 为第一个等于target的值
        if (start == nums.length || nums[start] != target) {
            return new int[] { -1, -1 };
        }
        // 找第一个大于 target 的数等价于找第一个大于等于 target+1 的数
        int end = lowerBound(nums, target + 1) - 1;
        return new int[] { start, end };
    }
    
    // LC.35
    public int lowerBound(int[] nums, int target) {
        int left = 0;
        int right = nums.length - 1;
        while (left <= right) {
            int mid = left + (right - left) / 2;
            if (nums[mid] < target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
        return left;
    }
}
```

**开区间**写法

```java
class Solution {
    public int[] searchRange(int[] nums, int target) {
        int start = lowerBound(nums, target);
        // 如果越界，或者找到的位置不是 target
        if (start == nums.length || nums[start] != target) {
            return new int[] { -1, -1 };
        }
        int end = lowerBound(nums, target + 1) - 1;
        return new int[] { start, end };
    }

    public int lowerBound(int[] nums, int target) {
        int left = -1;
        int right = nums.length;
        while (left + 1 < right) {
            int mid = (left + right) >>> 1;
            if (nums[mid] < target) {
                left = mid;
            } else {
                right = mid;
            }
        }
        return right;
    }
}
```

## 注意

注意处理边界值情况：
- 所有数都比 target 大：start = 0（left + 1）
- 所有数都比 target 小：start = nums.length
- 数组里面没有 target：nums[start] != target
